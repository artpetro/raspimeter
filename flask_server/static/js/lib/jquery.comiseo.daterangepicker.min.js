/*! https://github.com/tamble/jquery-ui-daterangepicker
 * Copyright (c) 2016 Tamble, Inc. Licensed MIT
 */

(function(c,F,P){function L(h,d,b){function g(b){a.button("option","label",b)}var a,k;k="drp_autogen"+z++;c('label[for="'+h.attr("id")+'"]').attr("for",k);a=c('<button type="button"></button>').addClass(d+"-triggerbutton").attr({title:h.attr("title"),tabindex:h.attr("tabindex"),id:k}).button({icons:{secondary:b.icon},label:b.initialText});return{getElement:function(){return a},getLabel:function(){return a.button("option","label")},setLabel:g,reset:function(){h.val("").change();g(b.initialText)},enforceOptions:function(){a.button("option",
{icons:{secondary:b.icon},label:b.initialText})}}}function G(h,d,b){var g,a;(function(){g=c("<div></div>").addClass(h+"-presets");a=c("<ul></ul>");c.each(d.presetRanges,function(){c('<li><a href="#">'+this.text+"</a></li>").data("dateStart",this.dateStart).data("dateEnd",this.dateEnd).click(b).appendTo(a)});g.append(a);a.menu().data("ui-menu").delay=0})();return{getElement:function(){return g}}}function M(h,d){function b(b,g){var a=c.datepicker.parseDate(d.datepickerOptions.dateFormat||c.datepicker._defaults.dateFormat,
b);!f.start||f.end?(f.start=a,f.end=null):a<f.start?(f.end=f.start,f.start=a):f.end=a;if(d.datepickerOptions.hasOwnProperty("onSelect"))d.datepickerOptions.onSelect(b,g)}function g(b){var c=[!0,f.start&&(+b===+f.start||f.end&&f.start<=b&&b<=f.end)?"ui-state-highlight":""],a=[!0,"",""];d.datepickerOptions.hasOwnProperty("beforeShowDay")&&(a=d.datepickerOptions.beforeShowDay(b));return[c[0]&&a[0],c[1]+" "+a[1],a[2]]}function a(){setTimeout(function(){k();a()},moment().endOf("day")-moment())}function k(){l.datepicker("refresh");
l.datepicker("setDate",null)}var l,f={start:null,end:null};l=c("<div></div>",{"class":h+"-calendar ui-widget-content"});l.datepicker(c.extend({},d.datepickerOptions,{beforeShowDay:g,onSelect:b}));a();return{getElement:function(){return l},scrollToRangeStart:function(){f.start&&l.datepicker("setDate",f.start)},getRange:function(){return f},setRange:function(b){f=b;k()},refresh:k,reset:function(){f={start:null,end:null};k()},enforceOptions:function(){l.datepicker("option",c.extend({},d.datepickerOptions,
{beforeShowDay:g,onSelect:b}))}}}function N(h,d,b){var g,a,k,l;g=c("<div></div>").addClass(h+"-buttonpanel");d.applyButtonText&&(a=c('<button type="button" class="ui-priority-primary"></button>').text(d.applyButtonText).button(),g.append(a));d.clearButtonText&&(k=c('<button type="button" class="ui-priority-secondary"></button>').text(d.clearButtonText).button(),g.append(k));d.cancelButtonText&&(l=c('<button type="button" class="ui-priority-secondary"></button>').text(d.cancelButtonText).button(),
g.append(l));b&&(a&&a.click(b.onApply),k&&k.click(b.onClear),l&&l.click(b.onCancel));return{getElement:function(){return g},enforceOptions:function(){a&&a.button("option","label",d.applyButtonText);k&&k.button("option","label",d.clearButtonText);l&&l.button("option","label",d.cancelButtonText)}}}function O(h,d,b){function g(){if(b.autoFitCalendars){var e=c(F).width(),d=n.outerWidth(!0),a=p.getElement(),f=a.datepicker("option","numberOfMonths"),h=f;if(d>e){for(;1<f&&n.outerWidth(!0)>e;)a.datepicker("option",
"numberOfMonths",--f);f!==h&&(g.monthWidth=(d-n.outerWidth(!0))/(h-f))}else for(;f<g.numberOfMonths&&e-n.outerWidth(!0)>=g.monthWidth;)a.datepicker("option","numberOfMonths",++f);H();C=!1}}function a(){m.getElement().click(I);m.getElement().keydown(z);x.click(function(e){q(e);r()});c(F).resize(function(){t?g():C=!0})}function k(e){var a=b.dateFormat;return c.datepicker.formatDate(a,e.start)+(+e.end!==+e.start?b.rangeSplitter+c.datepicker.formatDate(a,e.end):"")}function l(e){var a=b.altFormat,d={};
d.start=c.datepicker.formatDate(a,e.start);d.end=c.datepicker.formatDate(a,e.end);return JSON.stringify(d)}function f(e){var a=b.altFormat,d=null;if(e)try{d=JSON.parse(e,function(e,b){return e?c.datepicker.parseDate(a,b):b})}catch(f){}return d}function r(){var e=B();e?(m.setLabel(k(e)),p.setRange(e)):p.reset()}function A(e,a){var c=e||p.getRange();if(c.start){c.end||(c.end=c.start);e&&p.setRange(c);m.setLabel(k(c));h.val(l(c)).change();if(b.onChange)b.onChange();d._trigger("change",a,{instance:d})}}
function B(){return f(h.val())}function J(e){m.reset();p.reset();if(b.onClear)b.onClear();d._trigger("clear",e,{instance:d})}function K(e){var a=c(this),d=a.data("dateStart")().startOf("day").toDate(),a=a.data("dateEnd")().startOf("day").toDate();p.setRange({start:d,end:a});b.applyOnMenuSelect&&(q(e),A(null,e));return!1}function H(){n.position({my:"left top",at:"left bottom"+(0>b.verticalOffset?b.verticalOffset:"+"+b.verticalOffset),of:m.getElement(),collision:"flipfit flipfit",using:function(e,a){var c=
u,d,f=a.element.top+a.element.height/2,g=a.target.top+a.target.height/2,h=v;u=a.element.left+a.element.width/2>a.target.left+a.target.width/2?1:0;u!==c&&(b.mirrorOnCollision&&(d=0===u?w:p,n.children().first().append(d.getElement())),n.removeClass("comiseo-daterangepicker-"+y[c]),n.addClass("comiseo-daterangepicker-"+y[u]));n.css({left:e.left,top:e.top});v=f>g?3:2;v!==h&&(null!==h&&m.getElement().removeClass("comiseo-daterangepicker-"+y[h]),m.getElement().addClass("comiseo-daterangepicker-"+y[v]));
c=3===v&&a.element.top-a.target.top!==a.target.height+b.verticalOffset||2===v&&a.target.top-a.element.top!==a.element.height+b.verticalOffset;m.getElement().toggleClass("comiseo-daterangepicker-vfit",c)}})}function z(a){switch(a.which){case c.ui.keyCode.UP:case c.ui.keyCode.DOWN:a.preventDefault();a.stopPropagation();D(a);break;case c.ui.keyCode.ESCAPE:a.preventDefault();a.stopPropagation();q(a);r();break;case c.ui.keyCode.TAB:q(a)}}function D(a){t||(m.getElement().addClass("comiseo-daterangepicker-active"),
x.show(),t=!0,C&&g(),p.scrollToRangeStart(),n.show(),H());if(b.onOpen)b.onOpen();d._trigger("open",a,{instance:d})}function q(a){t&&(n.hide(),x.hide(),m.getElement().removeClass("comiseo-daterangepicker-active"),t=!1);if(b.onClose)b.onClose();d._trigger("close",a,{instance:d})}function I(a){t?(q(a),r()):D(a)}var n,x,m,w,p,E,t=!1,C=!1,y=["left","right","top","bottom"],u=1,v=null;(function(){m=L(h,"comiseo-daterangepicker",b);w=G("comiseo-daterangepicker",b,K);p=M("comiseo-daterangepicker",b);g.numberOfMonths=
b.datepickerOptions.numberOfMonths;g.numberOfMonths instanceof Array&&(b.autoFitCalendars=!1);E=N("comiseo-daterangepicker",b,{onApply:function(a){q(a);A(null,a)},onClear:function(a){q(a);J(a)},onCancel:function(a){d._trigger("cancel",a,{instance:d});q(a);r()}});n=c("<div></div>",{"class":"comiseo-daterangepicker comiseo-daterangepicker-"+y[u]+" ui-widget ui-widget-content ui-corner-all ui-front"}).append(c("<div></div>",{"class":"comiseo-daterangepicker-main ui-widget-content"}).append(w.getElement()).append(p.getElement())).append(c('<div class="ui-helper-clearfix"></div>').append(E.getElement())).hide();
h.hide().after(m.getElement());x=c("<div></div>",{"class":"ui-front comiseo-daterangepicker-mask"}).hide();c("body").append(x).append(n);g();r();a()})();return{toggle:I,destroy:function(){n.remove();m.getElement().remove();h.show()},open:D,close:q,setRange:A,getRange:B,clearRange:J,reset:r,enforceOptions:function(){var a=w;w=G("comiseo-daterangepicker",b,K);a.getElement().replaceWith(w.getElement());p.enforceOptions();E.enforceOptions();m.enforceOptions();(a=B())&&m.setLabel(k(a))},getContainer:function(){return n}}}
var z=0;c.widget("comiseo.daterangepicker",{version:"0.5.0",options:{presetRanges:[{text:"Today",dateStart:function(){return moment()},dateEnd:function(){return moment()}},{text:"Yesterday",dateStart:function(){return moment().subtract("days",1)},dateEnd:function(){return moment().subtract("days",1)}},{text:"Last 7 Days",dateStart:function(){return moment().subtract("days",6)},dateEnd:function(){return moment()}},{text:"Last Week (Mo-Su)",dateStart:function(){return moment().subtract("days",7).isoWeekday(1)},
dateEnd:function(){return moment().subtract("days",7).isoWeekday(7)}},{text:"Month to Date",dateStart:function(){return moment().startOf("month")},dateEnd:function(){return moment()}},{text:"Previous Month",dateStart:function(){return moment().subtract("month",1).startOf("month")},dateEnd:function(){return moment().subtract("month",1).endOf("month")}},{text:"Year to Date",dateStart:function(){return moment().startOf("year")},dateEnd:function(){return moment()}}],initialText:"Select date range...",
icon:"ui-icon-triangle-1-s",applyButtonText:"Apply",clearButtonText:"Clear",cancelButtonText:"Cancel",rangeSplitter:" - ",dateFormat:"M d, yy",altFormat:"yy-mm-dd",verticalOffset:0,mirrorOnCollision:!0,autoFitCalendars:!0,applyOnMenuSelect:!0,open:null,close:null,change:null,clear:null,cancel:null,onOpen:null,onClose:null,onChange:null,onClear:null,datepickerOptions:{numberOfMonths:3,maxDate:0}},_create:function(){this._dateRangePicker=O(this.element,this,this.options)},_destroy:function(){this._dateRangePicker.destroy()},
_setOptions:function(c){this._super(c);this._dateRangePicker.enforceOptions()},open:function(){this._dateRangePicker.open()},close:function(){this._dateRangePicker.close()},setRange:function(c){this._dateRangePicker.setRange(c)},getRange:function(){return this._dateRangePicker.getRange()},clearRange:function(){this._dateRangePicker.clearRange()},widget:function(){return this._dateRangePicker.getContainer()}})})(jQuery,window);
